---
description: 查询个人医疗记录
arguments:
  - name: query_type
    description: 查询类型：all(全部)/biochemical(生化检查)/imaging(影像检查)/recent(最近N条)/date(指定日期)/abnormal(异常指标)
    required: true
  - name: query_value
    description: 查询参数值（如日期、数量等）
    required: false
---

# 查询医疗记录

你需要查询个人医疗数据中心中的记录。

## 查询类型

### 1. 查询所有记录 - `all`
列出所有已保存的检查记录，按时间倒序排列。

### 2. 查询生化检查 - `biochemical`
只查询生化检查类记录。

### 3. 查询影像检查 - `imaging`
只查询影像检查类记录。

### 4. 查询最近N条记录 - `recent [数量]`
查询最近N条记录，默认10条。

### 5. 按日期查询 - `date [日期]`
查询指定日期的记录，格式：YYYY-MM-DD 或 YYYY-MM。

### 6. 查询异常指标 - `abnormal`
查询所有生化检查中的异常指标。

## 执行步骤

1. **读取索引文件**
   - 读取 `data/index.json`
   - 如果文件不存在，返回"暂无医疗记录"

2. **筛选记录**
   根据查询类型筛选记录：
   - 读取对应的 JSON 文件
   - 应用筛选条件

3. **格式化输出**
   以清晰的表格或列表形式展示查询结果

   **生化检查输出格式：**
   ```
   日期：YYYY-MM-DD
   检查类型：血液常规
   ━━━━━━━━━━━━━━━━━━━━━━━━━━
   检查项目          | 数值  | 单位    | 参考范围    | 状态
   ────────────────────────────────────────
   白细胞计数        | 6.5   | ×10^9/L | 3.5-9.5     | ✅ 正常
   血红蛋白          | 145   | g/L     | 130-175     | ✅ 正常
   血小板计数        | 189   | ×10^9/L | 125-350     | ✅ 正常
   ```

   **影像检查输出格式：**
   ```
   日期：YYYY-MM-DD
   检查类型：B超
   检查部位：腹部
   ━━━━━━━━━━━━━━━━━━━━━━━━━━
   检查所见：
   [描述内容]

   测量数据：
   - 尺寸：XXX

   检查结论：
   [结论内容]
   ```

4. **统计摘要**
   在查询结果后添加统计信息：
   - 总记录数
   - 生化检查数量
   - 影像检查数量
   - 时间跨度

## 注意事项

- 日期格式统一为 YYYY-MM-DD
- 异常指标用 ❌ 标记，正常用 ✅ 标记
- 如果记录过多，分页显示，每页20条
- 保持输出简洁清晰
- 如果查询结果为空，明确告知用户

## 示例用法

```
/query all                    # 查询所有记录
/query biochemical            # 查询所有生化检查
/query imaging                # 查询所有影像检查
/query recent 5               # 查询最近5条记录
/query date 2025-12           # 查询2025年12月的记录
/query date 2025-12-31        # 查询2025-12-31的记录
/query abnormal               # 查询所有异常指标
```
